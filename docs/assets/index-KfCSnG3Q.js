const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-D4vvl_YZ.js","assets/main-NIbdCOIG.css"])))=>i.map(i=>d[i]);
import{_ as e}from"./main-D4vvl_YZ.js";const t=[5.86,50.32,9.46,52.53];let r=1,o=1;const n={id:"nrw",supports(e){const r=(e[0]+e[2])/2,o=(e[1]+e[3])/2;var n,s,a,i,c;return c=t,!((i=e)[0]>c[2]||i[2]<c[0]||i[1]>c[3]||i[3]<c[1])||(a=o,(s=r)>=(n=t)[0]&&s<=n[2]&&a>=n[1]&&a<=n[3])},healthcheck:async()=>!0,async fetchRoadNetwork(t){const{polygonBbox4326:n}=await e(async()=>{const{polygonBbox4326:e}=await Promise.resolve().then(()=>d);return{polygonBbox4326:e}},void 0),[a,i,c,u]=n(t),l=new URL("https://www.wfs.nrw.de/wfs/DE_NW_SBV_INSPIRE_Downloadservice_Strassennetz");l.searchParams.set("service","WFS"),l.searchParams.set("version","2.0.0"),l.searchParams.set("request","GetFeature"),l.searchParams.set("typeNames","tn-ro:RoadLink"),l.searchParams.set("outputFormat","application/json"),l.searchParams.set("SRSNAME","EPSG:4326"),l.searchParams.set("bbox",`${a},${i},${c},${u},EPSG:4326`);try{const e=await fetch(l.toString());if(!e.ok)throw new Error(`NRW WFS failed: ${e.status} ${e.statusText}`);const t=await e.json(),{nodes:n,ways:a}=function(e){const t=[],n=[];for(const a of e.features){if(!a.geometry||"LineString"!==a.geometry.type)continue;const e=a.geometry,i=[];for(const[o,n]of e.coordinates){const e=r++;t.push({id:e,lon:o,lat:n}),i.push(e)}const c=s(a.properties||{});n.push({id:o++,nodeIds:i,tags:c})}return{nodes:t,ways:n}}(t);return a.length,{nodes:n,ways:a}}catch(f){throw new Error(`NRW WFS request failed: ${f instanceof Error?f.message:"Unknown error"}`)}},makeBasemapLayer:()=>L.tileLayer.wms("https://www.wms.nrw.de/geobasis/wms_nw_dtk",{layers:"nw_dtk_col",format:"image/png",transparent:!1,attribution:"© GEOBASIS.NRW"})};function s(e){const t={};return e.roadClass&&(t.highway=function(e){const t=String(e).toLowerCase();if(t.includes("motorway")||t.includes("autobahn"))return"motorway";if(t.includes("primary")||t.includes("hauptstrasse"))return"primary";if(t.includes("secondary")||t.includes("landstrasse"))return"secondary";if(t.includes("tertiary")||t.includes("kreisstrasse"))return"tertiary";if(t.includes("residential")||t.includes("wohngebiet"))return"residential";if(t.includes("service")||t.includes("zufahrt"))return"service";return"road"}(e.roadClass)),t.source="GEOBASIS.NRW",t}const a={id:"osm",supports:()=>!0,async fetchRoadNetwork(t){const{fetchOsmBundleForPolygon:r}=await e(async()=>{const{fetchOsmBundleForPolygon:e}=await import("./main-D4vvl_YZ.js").then(e=>e.o);return{fetchOsmBundleForPolygon:e}},__vite__mapDeps([0,1])),o=function(e){let t;if("features"in e&&e.features.length>0)t=e.features[0].geometry.coordinates[0];else{if(!("geometry"in e))throw new Error("Invalid polygon format for OSM provider");t=e.geometry.coordinates[0]}return t.map(e=>({lat:e[1],lng:e[0]}))}(t);try{return await r(o)}catch(n){throw new Error(`OSM request failed: ${n instanceof Error?n.message:"Unknown error"}`)}},makeBasemapLayer:()=>L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"})};const i=Object.freeze(Object.defineProperty({__proto__:null,osmProvider:a},Symbol.toStringTag,{value:"Module"}));function c(e){const t=[],r=e=>{e&&("Polygon"===e.type?e.coordinates[0].forEach(([e,r])=>t.push([e,r])):"Feature"===e.type?r(e.geometry):"FeatureCollection"===e.type&&e.features.forEach(e=>r(e)))};r(e);let o=180,n=90,s=-180,a=-90;for(const[i,c]of t)i<o&&(o=i),c<n&&(n=c),i>s&&(s=i),c>a&&(a=c);return[o,n,s,a]}function u(e){const t=JSON.stringify(e).slice(0,2048);let r=0;for(let o=0;o<t.length;o++)r=31*r+t.charCodeAt(o)|0;return`p${(r>>>0).toString(16)}`}const l=new Map;function f(e,t){return`${e}:${t}`}const d=Object.freeze(Object.defineProperty({__proto__:null,cacheKey:f,geoCache:l,polygonBbox4326:c,simplePolygonHash:u},Symbol.toStringTag,{value:"Module"})),y=[n,a];async function h(e){for(const r of y)try{if(!(await Promise.resolve(r.supports(e))))continue;if(r.healthcheck)try{if(!(await r.healthcheck()))continue}catch(t){continue}return r}catch(t){continue}return a}function p(e){const t=e.getBounds(),r=t.getSouthWest(),o=t.getNorthEast();return[r.lng,r.lat,o.lng,o.lat]}const g=Object.freeze(Object.defineProperty({__proto__:null,cacheKey:f,geoCache:l,getCurrentMapBbox4326:p,nrwProvider:n,osmProvider:a,pickProvider:h,polygonBbox4326:c,simplePolygonHash:u},Symbol.toStringTag,{value:"Module"}));export{l as a,f as c,p as g,g as i,i as o,h as p,u as s};
